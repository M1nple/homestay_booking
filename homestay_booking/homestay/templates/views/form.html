{% extends "base/base.html" %}
{% block title %} Test api {% endblock %}

{% block content %} 


    <label>Chọn Tỉnh:</label>
    <select id="tinh">
        <option value="">-- Chọn tỉnh --</option>
        {% for tinh in ds_tinh %}
            <option value="{{ tinh.id }}">{{ tinh.ten }}</option>
        {% endfor %}
    </select>

    <label>Chọn Quận/Huyện:</label>
    <select id="quan">
        <option value="">-- Chọn quận/huyện --</option>
    </select>

    <label>Chọn Xã/Phường:</label>
    <select id="xa">
        <option value="">-- Chọn xã/phường --</option>
    </select>


    <script>
        document.getElementById("tinh").addEventListener("change", function() {
            var tinhID = this.value;
            var quanSelect = document.getElementById("quan");
            quanSelect.innerHTML = '<option value="">-- Chọn quận/huyện --</option>';
            document.getElementById("xa").innerHTML = '<option value="">-- Chọn xã/phường --</option>'; // Reset Xã

            if (tinhID) {
                fetch(`/api/quan-huyen/?tinh_id=${tinhID}`)
                    .then(response => response.json())
                    .then(data => {
                        data.forEach(quan => {
                            var option = document.createElement("option");
                            option.value = quan.id;
                            option.textContent = quan.ten;
                            quanSelect.appendChild(option);
                        });
                    })
                    .catch(error => console.error("Lỗi khi gọi API:", error));
            }
        });

        document.getElementById("quan").addEventListener("change", function() {
            var quanID = this.value;
            var xaSelect = document.getElementById("xa");
            xaSelect.innerHTML = '<option value="">-- Chọn xã/phường --</option>';

            if (quanID) {
                fetch(`/api/xa-phuong/?quan_id=${quanID}`)
                    .then(response => response.json())
                    .then(data => {
                        data.forEach(xa => {
                            var option = document.createElement("option");
                            option.value = xa.id;
                            option.textContent = xa.ten;
                            xaSelect.appendChild(option);
                        });
                    })
                    .catch(error => console.error("Lỗi khi gọi API:", error));
            }
        });
    </script>

{% endblock %}
